"""
Generate level3.txt to level500.txt for platformer game
Run this script to create all level files with longer, combined layouts
Each level is now 4x longer by combining 4 sections
"""
import os
import random

# Create levels directory if it doesn't exist
os.makedirs('levels', exist_ok=True)

# Extended dimensions: 280 chars wide (4x70), 13 rows tall
WIDTH = 280
HEIGHT = 13
SECTION_WIDTH = 70

def create_level_3():
    return """..........................................................................C...............C...............C.......................................C.....C.....C...................................C.....C.................C...C...C.................................C..............................
..........................................................................###.............###.............###......................................###...###...###.................................###...###................###.###.###...............................###.............................
..........................................................................P.................E.................E.....................................E.............................E.....................E.....................E.......................E.............................
..C...............C...............C.......................................###.....................................................................##.....############.............C...C.......................................############.###..........................................................
.###.............###.............###..............................................C.....C.....C.....................................................C................................................................C.....C.......................................................
P.................E.................E.........................................#################.....................................................############.###..........................................................############.###..........................................................
###.....................................................................##................................................................................................................................................................................................................
........C.....C.....C.....................................................................................C...................................................................C..........................................C............................C...............................
....#################..............................................................................########.###.###.###................................................############.....................................................###############........................................................
...........................C...C...C......................................^..................................................................^......^......................................^...............########............^................................^...............
...........^...........#############..................^.......................########...............................................^.........................................########.....................................^......................^...............########............^...............
..............................................................C...........F...........................C...............................F...............................................................C...........F..................................................................C.......F
##################################################################.####################################.#######################################################################.#######################################################################.#######"""

def create_level_4():
    return """..........................................................................C.........C.........C.....................................................C.........C.........C.................................................C...C...C.................................C..............................
.........................................................................###.......###.......###.................................................###.......###.......###.................................................###.###.###...............................###.............................
.........C.......C.......C........................................................................................................................................................................................
........###.....###.....###...................................................................................................................................................................................
P...........................................E.................................P...................................E.....................................P...................................E.....................................P...................E.......................E.............................
####................................................................##########.......................................................................######........................................................................#####...............................................................######
............C...........C...........C..........................................................................................................................................................................................................................................
....########...........###.........###........................................########...........###.........###........................................############..........................................................############.###..........................................................
.......................................C..........................................C.......C.......C..........................................................................................................C.....................................................
.....................^.............####................................................................................................................................................................########................................########................................
...............########################...................^..........................########.###.###.###..................................................................^...............########............^................................^...............########............^...............
..................................................................C.......F..............^..........................................^................................................................................C.......F..................................................................C.......F
##################################################################.####################################.#######..........................########................................########.....................................#######################################################################.#######"""

def create_level_5():
    return """..........................................................................C.......................................................................C.................................C..............................C.......................C.........C.........C....................................................
..........................................................................###.....................................................................###...............................###.............................###.......###.......###...................................................
..........................................................................................................................................................................................................
....C...C...C.....................................C.......................###.............###.............###......................................C...C...C.................................C..............................................................................................................................................................
...###.###.###...................................###......................P.................E.................E.....................................###.###.###...............................###.............................P.......................................E.................................
P.....................E.................E.................................###.....................................................................##.....................................................................#######.................................................................######
######..............................................................######........C.....C.....C.....................................................############.###..........................................................................................C.....C...........................................
....................C.....C.....C.............................................#################.....................................................................................................................############.###..........................................
............############.###.###..........................................^..................................................................^......^.........................................................................................................................................................................................
.......^..................................................................^..................................................................^..................................................................C............................^..................................................................
...########...............................................^...................########...............................................^.........................................########............^................................^...................########.......................................
.....................................................C....................F...........................C...............................F............................................C.......F.............................................########....................................................................................C....F
##################################################################.####################################.#######################################################################.####################################.#######..............................................########.....................................#######"""

def create_level_6():
    return """..........................................................................................................................................................................................................
..........................................................................................................................................................................................................
.C.................................C......................................###...............................###.....................................C.................................C......................................................................................................................................................................
###...............................###.....................................P......C.................E................................................###...............................###.....................................P......C.................E................................................
P......C.................E................................................####..###............................................................#####........................................................................................................................................
####..###............................................................#####................C.....................................................................C.....................................................####..###............................................................#####................C.....................................................
................C.....................................................C.................................................................................................................................................................................................
........############..........C...C...C..............................................................................................................................................................................############..........C...C...C...................................
...................................###.###.###................................................................................................................................................................................................................###.###.###............................
..............^..........................................................................................................................................................................................................^...........................................................
..................########................................^.............................................................................................................................................................................................................................########................................^...............
.........................................................C................F...........................................................C................F.........................................................C................F...........................................................C................F
##################################################################.####################################.#######################################################################.####################################.#######################################################################.#######"""

def create_level_7():
    return """..........................................................................................................................................................................................................
..........................................................................................................................................................................................................
..........................................................................................................................................................................................................
..C.....C.....C...................................C.....C.................###...###...###.................................###...###................C.....C.....C...................................C.....C.................###...###...###.................................###...###................
.###...###...###.................................###...###................P.............................E.....................E.....................###...###...###.................................###...###................P.............................E.....................E.....................
P.............................E.....................E.....................#####...............................................................######.............................E.....................E.....................#####...............................................................######
#####...............................................................######.............C............................................................................C................................................................#####...............................................................######.............C................................................................
.............C................................................................############.............C...C.......................................############.............C...C.......................................############.............C...C.......................................############.............C...C.......................................
.....############.............C...C...............................................................########...............................................................########.......................................############.............C...C...............................................................########.......................................
...........................########...........................................................................................................................................................................................................................................
................^.................................................^.......^.................................................^.......^.................................................^.......^.................................................^.......
.....................................................................C....F.....................................................................C....F.....................................................................C....F.....................................................................C....F
##################################################################.####################################.#######################################################################.####################################.#######################################################################.#######"""

def create_level_8():
    return """..........................................................................................................................................................................................................
..........................................................................................................................................................................................................
........C.........C.........C.................................................###.......###.......###................................................C.........C.........C.................................................###.......###.......###................................................
.......###.......###.......###................................................P...................................E.....................................###.......###.......###................................................P...................................E.....................................
P...................................E.....................................######........................................................................###.......###.......###................................................######........................................................................
######........................................................................................................................................................................................................P...................................E.....................................
..............C.......C.......C...........................................................C.......C.......C..........................................................................................................######........................................................................
......########.###.###.###................................................########.###.###.###................................................C.......C.......C...........................................................C.......C.......C...........................................
..........................................C..............................................................................................................########.###.###.###................................................########.###.###.###................................................
..................................########................................................................C..............................................................................................................C...............................................
...............^..........................................^.............................########................................^.............................########..........................................................................C...............................................
..............................................................C...........F................................C...........F..............................................................C...........F..................................########................................
##################################################################.####################################.#######################################################################.####################################.#######..................................########................................"""

def create_level_9():
    return """..........................................................................................................................................................................................................
..........................................................................................................................................................................................................
..........................................................................................................................................................................................................
.C...C...C.................................C..............................###.###.###...............................###.............................C...C...C.................................C..............................###.###.###...............................###.............................
###.###.###...............................###.............................P...................E.......................E.............................###.###.###...............................###.............................P...................E.......................E.............................
P...................E.......................E.............................#####...............................................................######...................E.......................E.............................#####...............................................................######
#####...............................................................######................C.....C.......................................................................................................................#####...............................................................######................C.....C.......................................................
................C.....C.......................................................############.###..........................................................................................................................C.....C.......................................................############.###..........................................................
....############.###..........................................................^..................................................................^...............................................................................................................................................................................
.............................................C............................####.................................................................^..................................................................C............................####.................................................................
......................^...............########............^.............................................................................................................................................................................................................................########............^...............
..................................................................C.......F...........................................................C.......F..................................................................C.......F...........................................................C.......F
##################################################################.####################################.#######################################################################.####################################.#######################################################################.#######"""

def create_level_10():
    return """..........................................................................................................................................................................................................
..........................................................................................................................................................................................................
.....C.........C.........C....................................................###.......###.......###...................................................C.........C.........C....................................................###.......###.......###...................................................
....###.......###.......###...................................................P.......................................E.................................###.......###.......###...................................................P.......................................E.................................
P.......................................E.................................#######.................................................................######.......................................E.................................#######.................................................................######
#######.................................................................######....................C.....C...........................................................................................................#######.................................................................######....................C.....C...........................................
....................C.....C.......................................................############.###..........................................................................................................C.....C.......................................................############.###..........................................
............############.###..........................................^...................................................................................................................................................................................................
.......^.................................................................................................................................########...............................................^..................................................................^...................................................................
...########...........................................C.........................................................................................................################################################################...........................................C...................
..............................................########....................................................................................########....................................................................................########....................................................................................########....................
.....................................................................C....F.....................................................................C....F.....................................................................C....F.....................................................................C....F
##################################################################.####################################.#######################################################################.####################################.#######################################################################.#######"""

def generate_section(section_type, level_num, section_num, num_enemies, num_coins, num_spikes):
    """Generate one section (70 chars wide) of a level"""
    lines = [['.' for _ in range(SECTION_WIDTH)] for _ in range(HEIGHT)]
    
    # Seed untuk konsistensi per section
    random.seed(level_num * 1000 + section_num)
    
    # Top 3 rows empty
    # Row 3-5: Coins and platforms
    if section_type == 0:  # Staircase
        for i in range(min(3, num_coins)):
            pos = 8 + i * 18
            if pos < SECTION_WIDTH - 5:
                lines[3][pos] = 'C'
                for j in range(pos-1, min(pos+2, SECTION_WIDTH)):
                    lines[4][j] = '#'
    
    elif section_type == 1:  # Gaps
        positions = [10, 27, 44]
        for i, pos in enumerate(positions[:min(3, num_coins)]):
            if pos < SECTION_WIDTH - 5:
                lines[3][pos] = 'C'
                for j in range(pos-2, min(pos+3, SECTION_WIDTH)):
                    lines[4][j] = '#'
    
    elif section_type == 2:  # Vertical
        for i in range(min(4, num_coins)):
            pos = 10 + i * 12
            if pos < SECTION_WIDTH - 5:
                lines[3][pos] = 'C'
                for j in range(pos-1, min(pos+2, SECTION_WIDTH)):
                    lines[4][j] = '#'
    
    else:  # Dense
        for i in range(min(5, num_coins)):
            pos = 15 + i * 10
            if pos < SECTION_WIDTH - 5:
                lines[3][pos] = 'C'
    
    # Row 5: Player (first section only) and enemies
    if section_num == 0:
        lines[5][0] = 'P'
    
    for i in range(num_enemies):
        enemy_pos = 20 + i * 20
        if enemy_pos < SECTION_WIDTH - 5:
            lines[5][enemy_pos] = 'E'
    
    # Row 6: Main platform
    if section_num == 0:
        for i in range(min(10, SECTION_WIDTH)):
            lines[6][i] = '#'
    
    for i in range(max(0, SECTION_WIDTH - 10), SECTION_WIDTH):
        lines[6][i] = '#'
    
    # Row 7-8: Middle platforms
    if section_type == 0:
        platform_start = 12 + (section_num * 5)
        for i in range(platform_start, min(platform_start + 15, SECTION_WIDTH)):
            lines[8][i] = '#'
    elif section_type == 1:
        lines[8][10:25] = ['#'] * 15
        if 40 < SECTION_WIDTH:
            lines[8][40:55] = ['#'] * min(15, SECTION_WIDTH - 40)
    elif section_type == 2:
        for start in [12, 28, 44]:
            if start + 6 < SECTION_WIDTH:
                lines[8][start:start+6] = ['#'] * 6
    else:
        lines[8][10:50] = ['#'] * min(40, SECTION_WIDTH - 10)
    
    # Add some coins in middle
    if num_coins > 5:
        mid_coin_pos = random.randint(20, SECTION_WIDTH - 20)
        lines[7][mid_coin_pos] = 'C'
    
    # Row 9: Optional coin
    if num_coins > 8 and random.random() > 0.5:
        lines[9][random.randint(20, SECTION_WIDTH - 20)] = 'C'
    
    # Row 10: Spikes and platforms
    for i in range(num_spikes):
        spike_pos = 10 + i * 12
        if spike_pos < SECTION_WIDTH - 5:
            lines[10][spike_pos] = '^'
    
    platform_start = 8 + (section_num * 3)
    platform_len = 10 + (section_num * 2)
    for i in range(platform_start, min(platform_start + platform_len, SECTION_WIDTH - 8)):
        if lines[10][i] != '^':
            lines[10][i] = '#'
    
    # Row 11: Coin and finish (last section only)
    if section_num == 3:
        if num_coins > 10:
            lines[11][SECTION_WIDTH - 12] = 'C'
        lines[11][SECTION_WIDTH - 1] = 'F'
    
    # Row 12: Bottom platform
    for i in range(SECTION_WIDTH):
        lines[12][i] = '#'
    
    if section_num == 3:
        for i in range(SECTION_WIDTH - 8, SECTION_WIDTH - 1):
            lines[12][i] = '.'
        lines[12][SECTION_WIDTH - 1] = '#'
    
    return lines

def generate_advanced_level(level_num):
    """Generate level by combining 4 sections"""
    
    # Calculate difficulty
    difficulty = min((level_num - 10) / 490.0, 1.0)
    num_enemies = min(1 + (level_num // 15), 6)
    num_coins = min(4 + (level_num // 8), 15)
    num_spikes = min((level_num // 25), 8)
    
    # Choose section types (cycle through patterns)
    section_types = [
        (level_num + 0) % 4,
        (level_num + 1) % 4,
        (level_num + 2) % 4,
        (level_num + 3) % 4
    ]
    
    # Generate 4 sections
    all_sections = []
    for i in range(4):
        section_enemies = num_enemies // 4 + (1 if i < num_enemies % 4 else 0)
        section_coins = num_coins // 4 + (1 if i < num_coins % 4 else 0)
        section_spikes = num_spikes // 4 + (1 if i < num_spikes % 4 else 0)
        
        section = generate_section(
            section_types[i], 
            level_num, 
            i, 
            section_enemies, 
            section_coins, 
            section_spikes
        )
        all_sections.append(section)
    
    # Combine sections horizontally
    combined_lines = []
    for row in range(HEIGHT):
        row_line = []
        for section in all_sections:
            row_line.extend(section[row])
        combined_lines.append(''.join(row_line))
    
    return '\n'.join(combined_lines)

# Generate all levels
levels = {
    3: create_level_3(),
    4: create_level_4(),
    5: create_level_5(),
    6: create_level_6(),
    7: create_level_7(),
    8: create_level_8(),
    9: create_level_9(),
    10: create_level_10(),
}

# Add generated levels 11-500
for i in range(11, 501):
    levels[i] = generate_advanced_level(i)

# Write all level files
for level_num, level_data in levels.items():
    filename = f'levels/level{level_num}.txt'
    with open(filename, 'w') as f:
        f.write(level_data)
    print(f"Created {filename}")

print(f"\nSuccessfully created {len(levels)} level files (level3.txt to level500.txt)")
print("All files saved in 'levels/' directory")
print("\nEach level is now 280 characters wide (4x70) - 4 sections combined!")
print("Section types cycle through 4 different patterns:")
print("0: Staircase ascending")
print("1: Gap jumping")
print("2: Vertical challenges")  
print("3: Dense obstacles")
